# 需求文档 - 运营分析

## 1. 功能概述

- 1.1 功能名称：运营分析
- 1.2 功能概述：运营分析模块旨在基于适配中心汇集和管理的各类数据（包括客户数据、设备数据、业务数据等），提供多维度的统计分析能力。通过图表化展示和报表导出等功能，帮助运营人员洞察客户行为特征、评估设备资源效益、监控业务发展态势，从而为精细化运营、资源优化配置和业务决策提供数据支持。

## 2. 用户与场景

- 2.1 目标用户: 省级适配中心运营人员、业务分析师、运维管理人员、管理决策层。
- 2.2 用户场景/故事:
    - 场景一：作为一个省级适配中心运营经理，我想要按区域、行业等维度查看客户数量分布及活跃客户占比，以便了解不同客户群体的构成和参与度，为市场推广和客户维系策略提供依据。
    - 场景二：作为一个省级适配中心运维主管，我需要分析接入设备的厂商分布、在线率、故障频率以及视频流的平均利用率，以便评估设备健康度和资源使用效率，指导运维工作的优化和资源调整。
    - 场景三：作为一个省级适配中心业务分析师，我希望能统计各类视频业务（如点播、回放）的使用总量、并发峰值及时段分布，并分析其增长趋势和用户偏好，以便发现热门应用场景，支持新业务的规划和现有业务的迭代优化。
    - 场景四：作为一个省级适配中心管理人员，我需要定期导出客户分析、设备分析和业务分析的报表，以便于进行月度/季度回顾、编写运营报告和向上级汇报。

## 3. 功能范围/列表

- 3.1 功能模块一: 客户分析
- 3.2 功能模块二: 设备分析
- 3.3 功能模块三: 业务分析

## 4. 功能模块详情

---

### 4.1 功能模块：客户分析

#### 4.1.1 功能描述与目标

- 解决的问题: 运营团队需要深入了解其服务的省内客户群体的具体构成、活跃情况、资源使用习惯以及潜在价值，以便进行更精准的客户分层、服务和营销。
- 用户价值/目标: 通过多维度的数据分析，清晰描绘客户画像，识别高价值客户与流失风险客户，优化客户服务策略，提升客户满意度和业务收入。
- 核心能力概述: 基于适配中心管理或同步的客户数据，提供多维度分析能力，例如：按区域、行业、客户级别统计客户数量与分布情况；分析活跃客户数量、非活跃客户占比；统计客户平均资源使用量（如视频路数）；并可结合业务数据进行客户价值分析等，支持图表化展示和报表导出。 
    

#### 4.1.2 原型参考

- 主要原型页面: P_Analysis_Cust_Dashboard (客户分析主看板), P_Analysis_Cust_Report_Config (客户分析报表配置页)

#### 4.1.3 详细需求

##### 4.1.3.1 功能入口与触发条件

- 入口: 运营门户模块 -> 运营分析 -> 客户分析 [参考原型 P_Analysis_Cust_Dashboard]
- 触发条件: 用户已登录，并拥有“客户分析”功能的查看权限。

##### 4.1.3.2 交互流程与界面详述

- **A. 客户分析看板** [参考原型 P_Analysis_Cust_Dashboard]
    - 布局: 顶部为筛选条件区（如时间范围选择、区域/行业/客户级别等多维度筛选器），下方为多个分析图表和数据卡片展示区。
    - **数据维度 (可用于筛选和分组统计)**:
        - 时间维度: 日、周、月、季度、年，或自定义时间范围。
        - 地理区域: 省、市、区县（取决于客户数据中的区域信息粒度）。
        - 所属行业: 如金融、教育、交通等（基于客户信息中的行业分类）。
        - 客户级别: 如VIP客户、普通客户、测试客户等（基于客户信息中的级别定义）。
        - 客户来源: 如CRM同步、手动创建。
        - 客户状态: 如活跃、非活跃、即将流失（活跃度需定义规则）。
    - **关键指标与可视化展示**:
        - 1. 客户数量与分布统计:
            
            - 指标: 客户总数、各区域客户数、各行业客户数、各级别客户数。 
                
            - 可视化:
                - 数据卡片: 显示客户总数。
                - 地图热力图/区域划分图: 按地理区域展示客户数量分布。
                - 柱状图/饼图: 展示按行业、客户级别的客户数量及占比。 
                    
        - 2. 客户活跃度分析:
            
            - 指标: 活跃客户总数、非活跃客户总数、活跃客户占比、非活跃客户占比。 (活跃/非活跃定义：如过去N天内有无业务操作、资源使用等)
                
            - 可视化:
                - 数据卡片: 分别显示活跃/非活跃客户数。
                - 仪表盘/环形图: 显示活跃客户占比。
                - 折线图: 展示活跃客户数/占比随时间的变化趋势。
        - 3. 客户资源使用量分析:
            
            - 指标: 客户平均授权视频路数 、总授权视频路数、平均存储资源用量（若可统计）等。
                
            - 可视化:
                - 数据卡片: 显示平均值或总值。
                - 柱状图: 按客户级别/行业展示平均资源使用量对比。
        - 4. 客户价值分析 (结合业务数据):
            
            - 指标: (可选高级功能) 客户贡献度（如基于业务使用量、付费情况等计算的价值评分）、高价值客户占比。 
                
            - 可视化:
                - 散点图/气泡图: 按价值贡献与活跃度等维度分析客户群体。
                - 列表排名: 高价值客户Top N列表。
    - **交互功能**:
        - 筛选器: 用户可选择不同维度组合进行数据筛选和下钻。
        - 图表联动: 点击某一图表中的分类，其他相关图表可联动刷新数据。
        - 数据提示: 鼠标悬浮在图表元素上时，显示详细的数据值和说明。
        - 时间范围选择: 支持选择预设的时间范围（如近7天、近30天、本月、本年）或自定义起止日期。
- **B. 报表导出**
    - 触发: 在客户分析看板页面，提供“导出报表”按钮。
    - 交互步骤:
        - Step 1: 用户点击“导出报表”按钮。
        - Step 2: 系统可提供选项，允许用户选择导出当前看板视图（所见即所得的截图或PDF），或导出明细数据/汇总数据。
        - Step 3: 选择导出格式（如CSV、Excel、PDF）。 
            
        - Step 4: 系统后台生成报表文件并提供下载。对于大数据量导出，可采用异步生成并通过消息通知用户下载。

##### 4.1.3.3 数据定义 (分析维度与指标)

- **分析维度**: 见4.1.3.2 A. 数据维度部分。包括时间、地理区域、所属行业、客户级别、客户来源、客户状态等。
- **关键指标**: 见4.1.3.2 A. 关键指标与可视化展示部分。包括客户总数、各分类客户数及占比、活跃/非活跃客户数及占比、平均资源使用量、客户价值评分等。

##### 4.1.3.4 权限控制

- 功能访问权限: 拥有“客户分析-查看”权限的用户可以访问客户分析看板。
- 报表导出权限: 可设为与查看权限相同，或单独控制“客户分析-导出”权限。

#### 4.1.4 业务规则

- 数据来源: 客户分析的数据主要来源于适配中心的客户信息管理模块（包括手动录入和CRM同步的客户数据）以及客户资源授权管理模块的数据。活跃度、价值分析等可能需要结合业务日志或（省侧）业务分析模块的数据。
- 指标计算规则:
    - 活跃客户定义: 需明确定义活跃客户的标准，例如“在过去30天内至少有一次视频调阅行为的客户”或“当前有生效中资源授权的客户”。此规则应可由管理员在后台配置或系统预设。
    - 非活跃客户占比: (总客户数 - 活跃客户数) / 总客户数 * 100%。
    - 客户平均资源使用量: 特定资源总使用量 / 客户总数（或活跃客户数，需明确）。
- 数据更新频率: 分析看板的数据应定期更新，例如每日凌晨进行ETL处理和汇总计算。部分关键实时指标可支持更高频率的刷新。
- 历史数据保留: 运营分析模块应能支持对一定时间跨度（如过去1-3年）的历史数据进行分析。

#### 4.1.5 异常处理方案

- 数据为空或不足: 当筛选条件下无数据或数据量过少不足以生成有效分析图表时，界面应友好提示“暂无数据”或“数据量不足，无法生成分析图表”。
- 图表加载失败: 若因网络问题或后端服务异常导致图表无法加载，应显示加载失败的提示，并可尝试提供手动刷新按钮。
- 报表导出超时或失败: 对于大数据量的报表导出，若处理时间过长，应有进度提示或转为异步任务。若导出失败，应提示用户失败原因（如系统错误、无权限等）。

#### 4.1.6 与其他功能的关联和依赖

- **依赖项 (Dependencies)**:
    - 客户信息管理模块: 提供客户的基础信息和分类属性数据。
    - 客户授权资源管理模块: 提供客户的资源授权和使用数据。
    - （可选）业务日志/（省侧）业务分析模块: 提供客户业务行为数据，用于活跃度、价值分析等。
    - （可选）CRM同步模块: 是客户数据的重要来源之一。
- **被依赖项 (Generated Dependencies)**:
    - 无直接被其他功能模块强依赖，其产出的分析结果主要供人工决策和制定运营策略。

---

### 4.2 功能模块：设备分析

#### 4.2.1 功能描述与目标

- 解决的问题: 运维和运营团队需要全面了解通过适配中心接入的各类省级设备的数量分布、运行状态、故障情况以及资源利用效率，以便进行有效的设备管理、故障预警和资源优化。
- 用户价值/目标: 提升设备运维效率，保障设备运行稳定性，优化设备资源配置，降低运维成本，并为设备采购和升级提供数据支持。
- 核心能力概述: 针对通过适配中心接入的省级设备，进行多维度统计分析，例如：按设备厂商、型号、所属省级平台、接入区域统计设备数量和分布；分析设备在线率、离线时长、故障发生频率；评估设备视频流平均利用率、存储资源占用情况等，帮助优化资源配置和运维策略。 
    

#### 4.2.2 原型参考

- 主要原型页面: P_Analysis_Dev_Dashboard (设备分析主看板), P_Analysis_Dev_Report_Config (设备分析报表配置页)

#### 4.2.3 详细需求

##### 4.2.3.1 功能入口与触发条件

- 入口: 运营门户模块 -> 运营分析 -> 设备分析 [参考原型 P_Analysis_Dev_Dashboard]
- 触发条件: 用户已登录，并拥有“设备分析”功能的查看权限。

##### 4.2.3.2 交互流程与界面详述

- **A. 设备分析看板** [参考原型 P_Analysis_Dev_Dashboard]
    - 布局: 顶部为筛选条件区（如时间范围、设备厂商、型号、所属省级平台、接入区域等），下方为多个分析图表和数据卡片。
    - **数据维度 (可用于筛选和分组统计)**:
        - 时间维度: 日、周、月、季度、年，或自定义时间范围。
        - 设备厂商: 如海康、大华等。 
            
        - 设备型号。 
            
        - 所属省级平台: 如千里眼、移动看家、其他国标平台等。 11
            
        - 接入区域: 省、市、区县。 
            
        - 设备类型: 如IPC、NVR、编码器等。
        - 设备状态: 在线、离线、故障。
    - **关键指标与可视化展示**:
        - 1. 设备数量与分布统计:
            
            - 指标: 设备总数、各厂商设备数、各型号设备数、各省级平台接入设备数、各区域设备数。 
                
            - 可视化:
                - 数据卡片: 显示设备总数。
                - 柱状图/饼图: 展示按厂商、型号、省级平台、区域的设备数量及占比。 
                    
        - 2. 设备状态与健康度分析:
            
            - 指标: 设备在线率、平均离线时长、故障发生频率（按设备/型号/厂商统计）、Top N故障设备列表。 15
                
            - 可视化:
                - 仪表盘/环形图: 显示整体设备在线率。
                - 折线图: 展示在线率随时间的变化趋势。
                - 柱状图: 对比不同厂商/型号的平均离线时长或故障频率。
                - 表格: 展示Top N故障设备列表及其故障次数、累计离线时长。
        - 3. 设备资源利用率分析:
            
            - 指标: 设备视频流平均利用率（如实际观看/录制时长占总运行时长比例）、设备平均存储资源占用情况（如录像存储空间使用百分比，若可统计）。 
                
            - 可视化:
                - 数据卡片/仪表盘: 显示平均视频流利用率、平均存储占用率。
                - 柱状图: 按设备类型/区域展示利用率或占用率对比。
                - 列表: 展示资源利用率过低或过高的设备Top N列表。
    - **交互功能**:
        - 筛选器: 用户可选择不同维度组合进行数据筛选和下钻。
        - 图表联动与数据提示: 同客户分析。
        - 时间范围选择: 同客户分析。
- **B. 报表导出**
    - 触发与交互: 同客户分析模块的报表导出功能，允许导出设备分析相关的图表和数据。

##### 4.2.3.3 数据定义 (分析维度与指标)

- **分析维度**: 见4.2.3.2 A. 数据维度部分。包括时间、设备厂商、设备型号、所属省级平台、接入区域、设备类型、设备状态等。
- **关键指标**: 见4.2.3.2 A. 关键指标与可视化展示部分。包括设备总数、各分类设备数及占比、设备在线率、平均离线时长、故障发生频率、视频流平均利用率、存储资源占用情况等。

##### 4.2.3.4 权限控制

- 功能访问权限: 拥有“设备分析-查看”权限的用户可以访问设备分析看板。
- 数据权限 (可选): 可能限制用户查看特定区域或特定类型设备的分析数据。默认可查看所有设备的分析数据。
- 报表导出权限: 可设为与查看权限相同，或单独控制“设备分析-导出”权限。

#### 4.2.4 业务规则

- 数据来源: 设备分析的数据主要来源于适配中心的（省侧）设备管理模块（设备基础信息、状态信息）、（省侧）通道管理模块、南向协议适配模块的交互日志（用于判断在线、故障等），以及可能的流媒体处理模块（用于分析视频流利用率）。
- 指标计算规则:
    - 设备在线率: (当前在线设备数 / 总接入设备数) * 100%。可按日/周/月计算平均在线率。
    - 平均离线时长: 一段时间内，某设备/某类设备的总离线时长 / 离线次数（或设备数量）。
    - 故障发生频率: 一段时间内，某设备/某类设备的故障申告次数或系统检测到的故障事件次数。
    - 视频流平均利用率: (一段时间内，设备上所有视频流被有效访问或处理的总时长) / (设备总运行时长 * 视频流数量)。计算方式需根据实际采集的数据定义。
- 数据更新频率: 同客户分析，通常每日更新，部分状态类指标可更高频。

#### 4.2.5 异常处理方案

- 同客户分析模块的异常处理方案。

#### 4.2.6 与其他功能的关联和依赖

- **依赖项 (Dependencies)**:
    - （省侧）设备管理模块: 提供设备的基础信息、实时状态、厂商型号等。
    - （省侧）通道管理模块: 提供通道相关信息，辅助分析。
    - 南向接口适配模块/省级平台连接状态监控模块: 提供设备连接状态、心跳、故障等原始数据。
    - （省侧）流媒体处理与转发模块: （可能）提供视频流使用情况数据。
- **被依赖项 (Generated Dependencies)**:
    - 无直接被其他功能模块强依赖，其产出的分析结果主要供运维决策和资源优化。

---

### 4.3 功能模块：业务分析

#### 4.3.1 功能描述与目标

- 解决的问题: 运营和产品团队需要了解通过适配中心承载的各类视频业务的整体使用情况、用户行为偏好、业务性能瓶颈以及增长趋势，以便优化业务流程、提升用户体验和规划未来的业务发展方向。
- 用户价值/目标: 通过对视频业务数据的深入分析，发现业务热点和增长点，识别业务运行风险，为业务运营策略调整、产品功能迭代和市场推广提供数据驱动的决策支持。
- 核心能力概述: 针对通过适配中心承载的各类视频业务（如实时视频点播、录像回放、视频上云、智能分析等），统计各项业务的使用总量、并发峰值、用户访问时段分布、成功率等指标；分析不同业务的增长趋势、用户偏好和热点应用场景，为业务发展和运营策略提供数据支撑。 
    

#### 4.3.2 原型参考

- 主要原型页面: P_Analysis_Biz_Dashboard (业务分析主看板), P_Analysis_Biz_Report_Config (业务分析报表配置页)

#### 4.3.3 详细需求

##### 4.3.3.1 功能入口与触发条件

- 入口: 运营门户模块 -> 运营分析 -> 业务分析 [参考原型 P_Analysis_Biz_Dashboard]
- 触发条件: 用户已登录，并拥有“业务分析”功能的查看权限。

##### 4.3.3.2 交互流程与界面详述

- **A. 业务分析看板** [参考原型 P_Analysis_Biz_Dashboard]
    - 布局: 顶部为筛选条件区（如时间范围、业务类型、客户维度等），下方为多个分析图表和数据卡片。
    - **数据维度 (可用于筛选和分组统计)**:
        - 时间维度: 日、周、月、季度、年，或自定义时间范围。
        - 业务类型: 如实时视频点播、录像回放、视频上云、智能分析（如人脸识别、行为分析，若有）等。 
            
        - 客户维度: 可按客户ID、客户名称、客户行业、客户级别等进行筛选或聚合分析（需关联客户信息）。
        - 接入区域/设备维度: (可选) 分析特定区域或特定类型设备的业务承载情况。
    - **关键指标与可视化展示**:
        - 1. 业务使用总量与趋势分析:
            
            - 指标: 各项业务的总使用次数/请求量、总使用时长、总流量消耗（若可统计）等。 
                
            - 可视化:
                - 数据卡片: 显示核心业务的总量指标。
                - 柱状图/饼图: 展示不同业务类型的使用量占比。
                - 折线图: 展示各项业务使用总量随时间（日/周/月）的变化趋势。 
                    
        - 2. 业务并发与性能分析:
            
            - 指标: 各项业务的并发用户数峰值、平均并发用户数、业务请求成功率、平均响应时延。 
                
            - 可视化:
                - 折线图: 展示并发峰值随时间（如24小时分布）的变化。 
                    
                - 仪表盘/数据卡片: 显示关键业务的平均请求成功率。
                - 表格: 列出低成功率或高时延的业务操作（若能细分）。
        - 3. 用户行为与偏好分析:
            
            - 指标: 用户访问业务的时段分布（如24小时）、热门访问的资源类型/内容（若可分析到此粒度）、高频使用业务的用户群体特征（需结合客户维度）。 23
                
            - 可视化:
                - 热力图/柱状图: 展示业务访问的24小时分布或周分布。
                - 列表/词云: (若适用) 展示热门访问的资源标签或业务功能点。
        - 4. 业务热点与场景分析:
            
            - 指标: 不同业务类型在不同客户行业/区域的分布和使用强度，识别热点应用场景。 
                
            - 可视化:
                - 交叉分析表/气泡图: 结合客户维度和业务类型进行分析。
    - **交互功能**:
        - 筛选器: 用户可选择不同维度组合进行数据筛选和下钻。
        - 图表联动与数据提示: 同客户分析。
        - 时间范围选择: 同客户分析。
- **B. 报表导出**
    - 触发与交互: 同客户分析模块的报表导出功能，允许导出业务分析相关的图表和数据。

##### 4.3.3.3 数据定义 (分析维度与指标)

- **分析维度**: 见4.3.3.2 A. 数据维度部分。包括时间、业务类型、客户维度（ID、行业、级别）、区域/设备维度（可选）等。
- **关键指标**: 见4.3.3.2 A. 关键指标与可视化展示部分。包括业务使用总量（次数、时长、流量）、并发峰值、平均并发、请求成功率、平均响应时延、用户访问时段分布、热门资源/功能等。

##### 4.3.3.4 权限控制

- 功能访问权限: 拥有“业务分析-查看”权限的用户可以访问业务分析看板。
- 数据权限 (可选): 可能限制用户查看特定客户群体或特定业务类型的分析数据。默认可查看所有业务分析数据。
- 报表导出权限: 可设为与查看权限相同，或单独控制“业务分析-导出”权限。

#### 4.3.4 业务规则

- 数据来源: 业务分析的数据主要来源于适配中心处理各类视频业务时产生的业务日志、接口调用日志、流媒体会话日志等。部分分析可能需要关联客户信息管理模块和设备管理模块的数据。
- 指标计算规则:
    - 使用总量: 如视频点播次数、录像回放总时长。
    - 并发峰值: 在统计周期内（如每分钟、每5分钟）同时使用某项业务的最大用户数或会话数。
    - 请求成功率: (成功的业务请求次数 / 总的业务请求次数) * 100%。
    - 用户访问时段分布: 按小时或特定时间段统计业务请求量或活跃用户数。
- 数据更新频率: 同客户分析，通常每日进行ETL和汇总计算。并发等实时性要求高的指标，其统计周期应更短。

#### 4.3.5 异常处理方案

- 同客户分析模块的异常处理方案。

#### 4.3.6 与其他功能的关联和依赖

- **依赖项 (Dependencies)**:
    - 各具体视频业务处理模块（如实时点播服务、录像回放服务、视频上云接口、智能分析引擎接口等）的日志记录功能。
    - 北向接口调用日志。
    - （省侧）流媒体处理与转发模块的会话日志。
    - （可选）客户信息管理模块、设备管理模块: 用于进行关联维度分析。
- **被依赖项 (Generated Dependencies)**:
    - 无直接被其他功能模块强依赖，其产出的分析结果主要供业务决策、产品优化和运营策略制定。
    - （可选）可能会为智能告警系统提供基线数据或异常波动的输入。