# 需求文档 - 驾驶舱

## 1. 功能概述

- 1.1 功能名称：驾驶舱 
- 1.2 功能概述：驾驶舱作为运营门户的核心入口，旨在通过集中、直观的可视化方式，全面展示省级适配中心的关键运营数据、服务健康状态、省级平台连接情况以及核心运维指标和告警信息，帮助运营及运维人员快速掌握适配中心整体运行态势，及时发现潜在问题，为决策提供数据支持。

## 2. 用户与场景

- 2.1 目标用户: 省级适配中心运营人员、运维管理员、管理决策层。
- 2.2 用户场景/故事:
    - 场景一：作为一个省级适配中心运营人员，我想要在登录后第一眼看到当前已接入的设备总数、活动视频流数量以及服务的客户总数等核心运营指标 ，以便快速了解整体业务规模和活跃度。
        
    - 场景二：作为一个省级适配中心运维管理员，我希望能实时监控到适配中心各微服务的健康状况 、与各省级视频平台的接口连接状态 3以及关键协议的适配成功率 ，以便在出现异常时能第一时间介入处理。
        
    - 场景三：作为一个省级适配中心管理决策者，我希望能通过趋势图表回顾近期的业务增长情况，如设备接入增长趋势、客户数量增长趋势以及视频业务量的变化趋势 ，以便评估运营成效和规划未来发展。
        
    - 场景四：作为一个省级适配中心运维管理员，我需要快速概览当前系统中P0/P1级别的紧急告警数量及摘要信息 ，并了解系统整体资源（CPU、内存等）的使用情况 ，以便及时响应处理故障，保障系统稳定运行。
        

## 3. 功能范围/列表

- 3.1 省侧核心运营指标展示区
- 3.2 适配状态与服务健康度监控区
- 3.3 省级平台连接状态监控区
- 3.4 关键运维指标与告警概览区

## 4. 功能模块详情

---

### 4.1 功能模块：运营驾驶舱总览

#### 4.1.1 功能描述与目标

- 解决的问题: 需要一个集中区域展示适配中心最核心的运营数据，使用户能够快速了解当前的业务规模、资源接入情况和主要业务的活跃程度。
- 用户价值/目标: 提供宏观的业务运营快照，帮助用户快速把握整体运营态势，及时发现业务波动。
- 核心能力概述: 以数据卡片和统计图表等形式，展示已接入设备总数、按省级平台分类的设备数量统计、服务的客户总数、活动视频流数量以及实时的关键业务量统计。 
    

#### 4.1.2 原型参考

- 主要原型页面: P_Dashboard_Main (驾驶舱主界面 - 核心运营指标区)

#### 4.1.3 详细需求

##### 4.1.3.1 关键指标卡片组

- **已接入设备总数**
    - 数据来源: （省侧）设备管理模块统计的已纳管设备总数。
    - 展示形式: 数字卡片，突出显示总数，可带有趋势箭头（较上一周期对比）。
    - 刷新机制: 近实时更新（如每5分钟）或根据设备注册/注销事件触发更新。
 
- **省级平台接入数量**
    - 数据来源: 接口适配模块 -> 接入平台管理中已配置且状态为“已启用”的省级平台实例总数。
    - 展示形式: 数字卡片。
    - 刷新机制: 配置变更时更新或定期（如每小时）刷新。
    
- **服务客户总数**
    - 数据来源: 客户管理模块统计的有效客户总数（若由适配中心管理或同步）。 
        
    - 展示形式: 数字卡片，可带有趋势箭头。
    - 刷新机制: 近实时更新（如客户信息增删改时）或定期（如每1小时）刷新。
    
- **活动视频流数量**
    - 数据来源: （省侧）流媒体处理与转发模块统计的当前活跃（正在被拉取或转发）的视频流会话总数。 
        
    - 展示形式: 数字卡片，动态更新。
    - 刷新机制: 实时或准实时更新（如每10-30秒）。
    

##### 4.1.3.2 设备分布统计

- **各省级平台设备接入数量统计**
    - 数据来源: （省侧）设备管理模块，按设备所属“接入平台”（如千里眼、移动看家、其他国标平台等）进行分类统计。 11
        
    - 展示形式: 饼图或横向/纵向堆叠柱状图，清晰展示各类平台接入的设备数量及其占比。鼠标悬浮可显示具体数量和百分比。
    - 刷新机制: 近实时更新（如每5分钟）或根据设备注册/注销事件触发更新。
    

##### 4.1.3.3 实时业务量监控

- **视频调阅次数 (今日/本小时)**
    - 数据来源: 业务日志或接口调用日志，统计实时视频点播、录像回放等视频调阅类业务的请求次数。 
        
    - 展示形式: 折线图（展示今日内每小时趋势）和数字卡片（展示当前小时或今日累计）。
    - 刷新机制: 近实时更新（如每分钟汇总一次数据）。
    - 交互: 鼠标悬浮折线图可查看具体时间点的数据。
- **API调用量 (今日/本小时)**
    - 数据来源: 北向接口网关或各业务模块的接口调用日志，统计API被调用的总次数。 
        
    - 展示形式: 折线图（展示今日内每小时趋势）和数字卡片（展示当前小时或今日累计）。
    - 刷新机制: 近实时更新（如每分钟汇总一次数据）。
    - 交互: 可进一步下钻查看各主要API的调用分布（若有相关统计）。
- **数据传输量 (今日/本小时)**
    - 数据来源: 网络监控或流媒体模块，统计通过适配中心上行及下行的视频流媒体数据总量和信令数据总量。 
        
    - 展示形式: 折线图（展示今日内每小时趋势）和数字卡片（展示当前小时或今日累计，区分上行/下行）。
    - 刷新机制: 近实时更新（如每分钟汇总一次数据）。
    - 交互: 无。

---

### 4.2 适配状态与服务健康度监控区

#### 4.2.1 功能描述与目标

- 解决的问题: 需要实时了解适配中心自身各个微服务模块的运行状态以及关键的协议适配和数据同步任务的执行效果。
- 用户价值/目标: 确保运维人员能够快速感知适配中心内部服务的健康状况和核心适配能力的表现，及时发现和定位服务故障或适配效率问题。
- 核心能力概述: 通过仪表盘、状态指示和百分比图表等形式，展示各微服务模块的健康评分和运行状态、关键协议（如GB/T 28181）的适配成功率、核心数据同步任务的成功率，以及关键性能指标。 
    

#### 4.2.2 原型参考

- 主要原型页面: P_Dashboard_Main (驾驶舱主界面 - 适配与健康度区)

#### 4.2.3 详细需求

##### 4.2.3.1 服务状态仪表盘

- **各微服务模块健康评分/状态灯**
    - 数据来源: 适配中心健康与性能数据采集模块 16，通过心跳检测、资源使用率、错误率等综合评估各微服务（如南向接入服务、流媒体服务、北向接口服务等）的健康状况。
        
    - 展示形式:
        - 列表形式：每行一个微服务，显示服务名称、当前健康评分（如0-100分）、运行状态（如正常运行、性能警告、服务不可用）并通过不同颜色的状态灯（绿、黄、红）直观表示。 
            
        - 或采用概览仪表盘，显示整体服务健康度评分，并突出显示异常的服务模块。
    - 刷新机制: 近实时更新（如每30秒至1分钟）。


##### 4.2.3.2 协议适配成功率展示

- **GB/T 28181 适配成功率 (今日)**
    - 数据来源: 南向协议适配模块的信令交互日志，统计GB/T 28181协议关键信令（如注册、心跳、目录获取、点播请求等）的成功次数与总次数，计算成功率。 
        
    - 展示形式: 百分比仪表盘或进度条。
    - 刷新机制: 近实时更新（如每5分钟汇总统计）。
    - 交互: 鼠标悬浮可查看成功次数和总尝试次数。
- **核心数据同步成功率 (今日)**
    - 数据来源: 业务数据收集与处理模块的同步任务日志（如CRM客户数据同步、省级平台元数据同步等）。 
        
    - 展示形式: 列表形式，每行一个核心同步任务，显示任务名称和今日同步成功率（百分比）。
    - 刷新机制: 定期更新（如每10分钟或根据同步任务执行周期）。
 

##### 4.2.3.3 核心性能指标

- **北向接口平均响应时间**
    - 数据来源: 北向接口网关或各服务模块的接口调用日志，统计所有或关键北向API的平均响应耗时。 
        
    - 展示形式: 数字卡片（显示如近5分钟平均值）或小型折线图（显示近1小时趋势）。
    - 刷新机制: 近实时更新（如每分钟）。
    - 交互: 无。
- **北向接口调用成功率**
    - 数据来源: 北向接口网关或各服务模块的接口调用日志，统计调用成功次数与总次数。 
        
    - 展示形式: 百分比仪表盘或数字卡片。
    - 刷新机制: 近实时更新（如每分钟）。
    - 交互: 无。
- **当前管理设备总体在线率**
    - 数据来源: （省侧）设备管理模块，统计当前状态为“在线”的设备数量与纳管设备总数的比率。 
        
    - 展示形式: 百分比仪表盘或数字卡片。
    - 刷新机制: 近实时更新（如每分钟）。


---

### 4.3 省级平台连接状态监控区

#### 4.3.1 功能描述与目标

- 解决的问题: 需要集中监控适配中心与所有已对接的省级视频平台之间的连接状态和交互质量，确保南向通道的畅通和稳定。
- 用户价值/目标: 帮助运维人员快速定位与特定省级平台连接失败或交互异常的问题，保障数据采集和业务调用的可靠性。
- 核心能力概述: 清晰、实时地展示与每一个已配置的省级视频平台的网络连接状态、认证状态、最新心跳时间 ，并监控关键的网络质量指标和接口调用统计。
    

#### 4.3.2 原型参考

- 主要原型页面: P_Dashboard_Main (驾驶舱主界面 - 省级平台连接区)

#### 4.3.3 详细需求

##### 4.3.3.1 平台连接状态矩阵

- **各省级平台连接、认证、心跳状态**
    - 数据来源: 接口适配模块 -> 接入平台管理模块，以及省级平台连接与交互状态数据采集模块。 24
        
    - 展示形式: 表格或矩阵形式。每行代表一个已配置的省级视频平台（如千里眼平台A、移动看家平台B）。列包括：平台名称、网络连接状态（如TCP连接通/断，可通过Ping或实际端口连接状态判断）、应用层认证状态（成功/失败/未认证）、最新心跳接收时间。 25 使用不同颜色的图标（绿、黄、红）直观表示状态。
        
    - 刷新机制: 近实时更新（如每30秒至1分钟）。


##### 4.3.3.2 网络质量监控 (针对主要省级平台)

- **网络延时 (Ping RTT)**
    - 数据来源: 省级平台连接与交互状态数据采集模块，对各主要省级平台的网络接口进行定期Ping测试。 
        
    - 展示形式: 小型折线图或列表，展示近期的平均延时和当前延时。对超过阈值的延时进行告警色标示。
    - 刷新机制: 定期更新（如每分钟）。
    - 交互: 无。
- **网络丢包率**
    - 数据来源: 省级平台连接与交互状态数据采集模块，通过Ping测试统计。 
        
    - 展示形式: 百分比或小型折线图。对超过阈值的丢包率进行告警色标示。
    - 刷新机制: 定期更新（如每分钟）。
    - 交互: 无。
- **接口带宽使用情况 (可选)**
    - 数据来源: 网络监控设备或相关接口统计。
    - 展示形式: 仪表盘或百分比，显示与主要省级平台接口的当前带宽占用率。
    - 刷新机制: 近实时更新。
    - 交互: 无。

##### 4.3.3.3 南向接口调用统计 (针对主要省级平台)

- **接口调用成功/失败次数 (今日)**
    - 数据来源: 南向接口适配模块的交互日志，或省级平台连接与交互状态数据采集模块。 
        
    - 展示形式: 柱状图或表格，按省级平台分别展示今日调用其接口的成功次数和失败次数。
    - 刷新机制: 近实时更新（如每5分钟汇总）。
    - 交互: 点击可查看该平台接口调用的详细失败原因统计（若有）。
- **接口平均响应时间趋势 (近1小时)**
    - 数据来源: 南向接口适配模块的交互日志，或省级平台连接与交互状态数据采集模块。 
        
    - 展示形式: 折线图，按省级平台分别展示近1小时调用其接口的平均响应时间变化趋势。
    - 刷新机制: 近实时更新（如每分钟）。
    - 交互: 无。

---

### 4.4 关键运维指标与告警概览区

#### 4.4.1 功能描述与目标

- 解决的问题: 需要一个统一的区域来汇总展示对系统稳定运行至关重要的运维性能指标、当前的告警状况以及长期的业务和资源趋势。
- 用户价值/目标: 使运维人员能够快速掌握系统的告警态势和资源瓶颈，同时通过业务趋势分析为容量规划和优化提供依据。
- 核心能力概述: 以醒目方式展示当前活跃的、P0/P1级别的未处理告警数量和摘要信息 ，并通过图表展示关键业务的历史趋势、设备和客户的增长趋势 ，以及适配中心自身系统资源的实时使用情况 。
    

#### 4.4.2 原型参考

- 主要原型页面: P_Dashboard_Main (驾驶舱主界面 - 运维与告警区)

#### 4.4.3 详细需求

##### 4.4.3.1 告警统计面板

- **P0/P1级别告警数量 (当前未处理)**
    - 数据来源: 运行监控与告警生成模块，筛选出当前活跃且未关闭的P0（严重）和P1（主要）级别告警。 
        
    - 展示形式: 数字卡片，分别显示P0和P1告警数量，使用醒目的颜色（如红色代表P0）。 
        
    - 刷新机制: 实时或准实时更新（有新告警或告警状态变更时）。
    - 交互: 点击告警数量，可跳转至详细的告警列表页面，并按相应级别筛选。 
        
- **未处理告警摘要列表**
    - 数据来源: 运行监控与告警生成模块，展示最新的若干条（如5条）未处理的P0/P1告警摘要信息。 
        
    - 展示形式: 滚动列表或静态列表，每条摘要包含告警时间、告警级别、告警对象、告警内容简述。 
        
    - 刷新机制: 实时或准实时更新。
    - 交互: 点击某条告警摘要，可跳转至该告警的详情页面。

##### 4.4.3.2 业务趋势图表

- **近30天视频业务处理总量趋势**
    - 数据来源: 业务日志或接口调用与业务趋势统计数据，按日统计视频调阅、录像等核心视频业务的处理总量。 38
        
    - 展示形式: 折线图或柱状图。
    - 刷新机制: 每日更新。
    - 交互: 鼠标悬浮可查看具体日期的数据量。
- **近30天/6个月设备数量增长趋势**
    - 数据来源: （省侧）设备管理模块的历史数据或接口调用与业务趋势统计数据。 
        
    - 展示形式: 折线图。
    - 刷新机制: 每日更新。
    - 交互: 鼠标悬浮可查看具体日期的数据量。
- **近30天/6个月客户数量增长趋势**
    - 数据来源: 客户管理模块的历史数据或接口调用与业务趋势统计数据（若客户数据由适配中心管理或同步）。 
        
    - 展示形式: 折线图。
    - 刷新机制: 每日更新。
    - 交互: 鼠标悬浮可查看具体日期的数据量。

##### 4.4.3.3 系统资源使用情况 (适配中心自身)

- **CPU使用率**
    - 数据来源: 适配中心健康与性能数据采集模块，采集各服务进程或宿主机的CPU使用率。 
        
    - 展示形式: 仪表盘或百分比条，显示整体平均CPU使用率或关键节点CPU使用率。
    - 刷新机制: 近实时更新（如每10-30秒）。
    - 交互: 可点击查看各节点/服务的详细CPU使用趋势。
- **内存占用率**
    - 数据来源: 适配中心健康与性能数据采集模块。 
        
    - 展示形式: 仪表盘或百分比条。
    - 刷新机制: 近实时更新。
    - 交互: 可点击查看各节点/服务的详细内存使用趋势。
- **存储资源占用情况**
    - 数据来源: 适配中心健康与性能数据采集模块，监控日志存储、临时文件存储等关键路径的磁盘空间占用率。 
        
    - 展示形式: 百分比条。
    - 刷新机制: 定期更新（如每5分钟）。
    - 交互: 无。
- **网络吞吐量 (整体)**
    - 数据来源: 适配中心健康与性能数据采集模块，监控适配中心服务器整体的网络流入/流出速率。         
    - 展示形式: 实时速率图（如折线图）。
    - 刷新机制: 近实时更新（如每10-30秒）。
    - 交互: 无。